var map;var geocoder;var markers=[];var markercount=0;var circles=[];var switching=true;var openingpopup=true;var emsg="Something went wrong: ";function initialize(){geocoder=new google.maps.Geocoder();var a={zoom:5};map=new google.maps.Map(document.getElementById("map-canvas"),a);handleNoGeolocation(false);google.maps.event.addListener(map,"zoom_changed",function(b){ReplaceMarker()});plotExistingMarkers()}function setAllMap(b){markercount=0;for(var a=0;a<markers.length;a++){setTimeout(function(){if(b!=null){markers[markercount].setAnimation(google.maps.Animation.DROP)}markers[markercount++].setMap(b)},a*100)}}function setAllCircleMap(b){for(var a=0;a<circles.length;a++){circles[a].setMap(b)}}function ReplaceMarker(){if(map.getZoom()<3){map.setZoom(4)}if(map.getZoom()>8&&switching==true){setAllCircleMap(null);setAllMap(map);switching=false}else{if(map.getZoom()<8&&switching==false){setAllCircleMap(map);setAllMap(null);switching=true}}}function plotExistingMarkers(){$.post("nitro/nitro.php?action=getMarkers").done(function(d){if(typeof d=="string"){d=jQuery.parseJSON(d)}if(d.errorcode!=0||d.message!="Done"){bootbox.alert(emsg+d.message);return}if(d.markers==null){console.log("Nothing to show");return}for(var c=0;c<d.markers.length;c++){var e=new google.maps.LatLng(d.markers[c].Lat,d.markers[c].Lng);var b={strokeColor:"#FF0000",strokeOpacity:0.2*d.markers[c].Severe,strokeWeight:2,fillColor:"#FF0000",fillOpacity:0.2*d.markers[c].Severe,map:map,center:e,radius:1000};dirtyCircle=new google.maps.Circle(b);circles.push(dirtyCircle);var a=new google.maps.Marker({position:e,map:null,draggable:false,animation:google.maps.Animation.DROP});markers.push(a);google.maps.event.addListener(a,"click",function(){if(openingpopup){openingpopup=false}else{return}var f=this.getPosition();$.ajax({url:"nitro/nitro.php?action=getImage&Lat="+f.lat()+"&Lng="+f.lng(),type:"POST",success:function(g){if(typeof g=="string"){g=jQuery.parseJSON(g)}var h=bootbox.alert(g.imgdiv).toString();infowindow.setContent(h);geocoder.geocode({latLng:f},function(j,i){if(i==google.maps.GeocoderStatus.OK){if(j[1]){$("#cord").text(j[1].formatted_address)}}});openingpopup=true},failure:function(g){openingpopup=true}})})}})}var infowindow=new google.maps.InfoWindow({content:""});function handleNoGeolocation(b){var a={map:map,position:new google.maps.LatLng(21.1289956,82.7792201)};map.setCenter(a.position)}google.maps.event.addDomListener(window,"load",initialize);